*UPTODATE P01AAETEXT
      INTEGER FUNCTION P01AAE(IFAIL, ERROR, SRNAME)
C     MARK 1 RELEASE.  NAG COPYRIGHT 1971
C     MARK 3 REVISED
C     MARK 4A REVISED, IER-45
C     MARK 4.5 REVISED
C     MARK 7 REVISED (DEC 1978)
C     RETURNS THE VALUE OF ERROR OR TERMINATES THE PROGRAM.
      INTEGER ERROR, IFAIL, NOUT
      CHARACTER SRNAME*8
C     TEST IF NO ERROR DETECTED
      IF (ERROR.EQ.0) GO TO 20
C     DETERMINE OUTPUT UNIT FOR MESSAGE
      CALL X04AAE (0,NOUT)
C     TEST FOR SOFT FAILURE
      IF (MOD(IFAIL,10).EQ.1) GO TO 10
C     HARD FAILURE
c modified by MUH to suit RM-FORTRAN ON IBM-PC
      PRINT 99999 ,SRNAME, ERROR
C     WRITE (NOUT,99999) SRNAME, ERROR
C     STOPPING MECHANISM MAY ALSO DIFFER
      STOP
C     SOFT FAIL
C     TEST IF ERROR MESSAGES SUPPRESSED
   10 IF (MOD(IFAIL/10,10).EQ.0) GO TO 20
c next line modified by muh to IBM-PC RM-FORTRAN
c     WRITE (NOUT,99999) SRNAME, ERROR
      PRINT 99999, SRNAME, ERROR
   20 P01AAE = ERROR
      RETURN
c!   NEXT LINE MODIFIED BY E.L.KOSAREV FOR HP-1000
99999 FORMAT (39H ERROR DETECTED BY NAF LIBRARY ROUTINE , A8,
     * 11H - IFAIL = , I5//)
      END
** END OF P01AAETEXT
*** END OF NAF037 ***
