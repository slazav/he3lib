#!/usr/bin/gnuplot

 # formula from Huang-2012

 # liquid
F(n,x) = cos(n*acos(x))

t1=0.001
t2=3.3157
t3=3.3157
t4=300
p1 = 0
p2 = 20000

x1(t) = -1 + 2.0*(log(t)-log(t1))/(log(t2)-log(t1))
x2(t) = -1 + 2.0*(log(t)-log(t3))/(log(t4)-log(t3))
y(p)  = -1 + 2.0*(p-p1)/(p2-p1)

a01 = -0.105665
a02 = -0.236672
a03 = -0.515789
a04 = 0.0368286
a11 = 0.00671712
a12 = 0.38306
a13 = 0.830913
a21 = 0.0780033
a22 = 0.0741736
a31 = -0.00358848

a00 = - 8.502104326
a01 = - 0.212634991
a02 = - 0.1284320028
a03 = - 0.0348041443
a04 = - 0.0109054008
a10 = - 5.781126976
a11 = + 0.364977795
a12 = + 0.1265706577
a13 = + 0.0968821863
a20 = + 1.0382238703
a21 = + 0.0208418086
a22 = + 0.0685042034
a30 = + 0.3584021376
a31 = + 0.0238452264
a40 = - 0.0386854588

eta_liq(t,p) =exp(\
a00\
+ a01 * F(1,y(p))\
+ a02 * F(2,y(p))\
+ a03 * F(3,y(p))\
+ a04 * F(4,y(p))\
+ a10 * F(1,x1(t))\
+ a11 * F(1,x1(t))*F(1,y(p))\
+ a12 * F(1,x1(t))*F(2,y(p))\
+ a13 * F(1,x1(t))*F(3,y(p))\
+ a20 * F(2,x1(t))\
+ a21 * F(2,x1(t))*F(1,y(p))\
+ a22 * F(2,x1(t))*F(2,y(p))\
+ a30 * F(3,x1(t))\
+ a31 * F(3,x1(t))*F(1,y(p))\
+ a40 * F(4,x1(t)) )


 # gas
eta_gas(t,p) = (\
 + 21.5131705\
 +  0.7010741  * F(1,y(p))\
 +  0.3791132  * F(2,y(p))\
 +  0.0465149  * F(3,y(p))\
 +  0.0155946  * F(4,y(p))\
 +  0.0316009  * F(5,y(p))\
 + 31.1827143  * F(1,x2(t))\
 -  0.2206122  * F(1,x2(t))*F(1,y(p))\
 -  0.0742733  * F(1,x2(t))*F(2,y(p))\
 -  0.33982901 * F(1,x2(t))*F(3,y(p))\
 +  0.1288428  * F(1,x2(t))*F(4,y(p))\
 + 16.9991092  * F(2,x2(t))\
 -  0.2202063  * F(2,x2(t))*F(1,y(p))\
 -  0.0422274  * F(2,x2(t))*F(2,y(p))\
 -  0.1732004  * F(2,x2(t))*F(3,y(p))\
 +  6.8529336  * F(3,x2(t))\
 +  0.55095604 * F(3,x2(t))*F(1,y(p))\
 +  0.349605   * F(3,x2(t))*F(2,y(p))\
 +  2.2583123  * F(4,x2(t))\
 -  0.1081992  * F(4,x2(t))*F(1,y(p))\
 +  0.4371826  * F(5,x2(t)) )* 1e-6

set log
#unset key

# Huang-2012
eta_hu(t) = ( 2.897e-7/t**2 - 7.02e-7/t**1.5 + 2.012e-6/t + 1.323e-6)

fitfunc(x,y) = log(eta_liq(x,y))
fit fitfunc(x,y) "huang2012_fig8.txt" using 2:1:(log($3)) via a00,a01,a02,a03,a04,a10,a11,a12,a13,a20,a21,a22,a30,a31,a40
#fit fitfunc(x,y) "huang2012_fig8.txt" using 2:1:(log($3)) via a01,a02,a03,a04,a11,a12,a13,a21,a22,a31
#fit fitfunc(x,y) "huang2012_fig8.txt" using 2:1:(log($3)) via a01,a02,a03,a04,a11,a12,a13,a21,a22,a31


plot [0.001:3.3157]\
  eta_liq(x, 10),\
  eta_liq(x, 1000),\
  eta_liq(x, 5000),\
  eta_liq(x, 20000),\
  eta_hu(x),\
  "huang2012_fig8.txt" using 2:3,\
  "../visc_1963_betts.txt" using 1:($2/10e6)

pause -1

unset log
set key
set log y

plot [0.001:0.01] [1e-3:2e-1]\
  eta_liq(x, 0),\
  eta_hu(x)

pause -1


